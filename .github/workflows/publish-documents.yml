name: Publish Documents

on:
  push:
    branches:
      - main
    paths:
      - 'docs/**'
      - 'data/**'
      - '.github/workflows/publish-documents.yml'

jobs:
  publish:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Setup directories
      run: |
        mkdir -p ./release-assets
        mkdir -p ./docs
        mkdir -p ./data
    
    - name: Create Release
      id: create_release
      uses: actions/create-release@v1
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        tag_name: v${{ github.run_number }}
        release_name: Release v${{ github.run_number }}
        body: |
          # TÃ¼rkiye'nin Tam OrtasÄ± - Belgeler YayÄ±nÄ±
          
          **ðŸŒ Web Sitesi:** https://merkez.web.tr/
          
          Bu yayÄ±n aÅŸaÄŸÄ±daki belgeleri iÃ§erir:
          - ðŸ“Š Raporlar (TR/EN)
          - ðŸ“ Koordinat Verileri (CSV, GeoJSON)
          - ðŸ—ºï¸ Harita DosyalarÄ±
          - ðŸ“š DokÃ¼mantasyon
          
          ## ðŸ“¥ Ä°ndirme
          AÅŸaÄŸÄ±dan belgeleri indirebilirsiniz.
          
          ## ðŸ”— BaÄŸlantÄ±lar
          - **Web Sitesi**: https://merkez.web.tr/
          - **E-posta**: info@merkez.web.tr
          - **GitHub**: https://github.com/turkiyeninortasi/turkiyenin-ortasi-belgeler
        draft: false
        prerelease: false
    
    - name: Upload Report TR
      uses: actions/upload-release-asset@v1
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        upload_url: ${{ steps.create_release.outputs.upload_url }}
        asset_path: ./docs/TÃ¼rkiye_Tam_OrtasÄ±_DoÄŸrulama_RaporÄ±.pdf
        asset_name: TÃ¼rkiye_Tam_OrtasÄ±_DoÄŸrulama_RaporÄ±.pdf
        asset_content_type: application/pdf
    
    - name: Upload Report EN
      uses: actions/upload-release-asset@v1
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        upload_url: ${{ steps.create_release.outputs.upload_url }}
        asset_path: ./docs/Turkey_Geographic_Center_Verification_Report.pdf
        asset_name: Turkey_Geographic_Center_Verification_Report.pdf
        asset_content_type: application/pdf
    
    - name: Upload Coordinates CSV
      uses: actions/upload-release-asset@v1
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        upload_url: ${{ steps.create_release.outputs.upload_url }}
        asset_path: ./data/turkiye_merkez_koordinatlari.csv
        asset_name: turkiye_merkez_koordinatlari.csv
        asset_content_type: text/csv
    
    - name: Upload GeoJSON
      uses: actions/upload-release-asset@v1
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        upload_url: ${{ steps.create_release.outputs.upload_url }}
        asset_path: ./data/turkiye_merkez_harita.geojson
        asset_name: turkiye_merkez_harita.geojson
        asset_content_type: application/json
    
    - name: Update README
      run: |
        echo "# TÃ¼rkiye'nin Tam OrtasÄ± - Belgeler Deposu" > README.md
        echo "" >> README.md
        echo "Bu depo TÃ¼rkiye'nin coÄŸrafi merkezi hakkÄ±ndaki resmi belgeleri ve veri dosyalarÄ±nÄ± iÃ§erir." >> README.md
        echo "" >> README.md
        echo "**ðŸŒ Web Sitesi:** [https://merkez.web.tr/](https://merkez.web.tr/)" >> README.md
        echo "" >> README.md
        echo "## ðŸ“Š Belgeler" >> README.md
        echo "- ðŸ“„ Raporlar (PDF - TÃ¼rkÃ§e & Ä°ngilizce)" >> README.md
        echo "- ðŸ“Š Koordinat Verileri (CSV)" >> README.md
        echo "- ðŸ—ºï¸ Harita DosyalarÄ± (GeoJSON)" >> README.md
        echo "" >> README.md
        echo "## ðŸ“¥ Ä°ndirme" >> README.md
        echo "[En son yayÄ±nÄ± indir](https://github.com/turkiyeninortasi/turkiyenin-ortasi-belgeler/releases/latest)" >> README.md
        echo "" >> README.md
        echo "## ðŸŽ¯ Merkez KoordinatlarÄ±" >> README.md
        echo "- **Enlem:** 39.245472Â° N" >> README.md
        echo "- **Boylam:** 35.487361Â° E" >> README.md
        echo "- **Konum:** EÅŸrefpaÅŸa/Ã‡andÄ±r, Yozgat" >> README.md
        echo "- **Koordinat Sistemi:** WGS84 (EPSG:4326)" >> README.md
        echo "" >> README.md
        echo "## ðŸ”— BaÄŸlantÄ±lar" >> README.md
        echo "- [Web Sitesi](https://merkez.web.tr/)" >> README.md
        echo "- [Belgeler](https://merkez.web.tr/belgeler/)" >> README.md
        echo "- [Ä°letiÅŸim](mailto:info@merkez.web.tr)" >> README.md
        echo "- [GitHub Repository](https://github.com/turkiyeninortasi/turkiyenin-ortasi-belgeler)" >> README.md
        echo "" >> README.md
        echo "---" >> README.md
        echo "" >> README.md
        echo "**Son GÃ¼ncelleme:** $(date)" >> README.md
        echo "**Konum:** EÅŸrefpaÅŸa/Ã‡andÄ±r, Yozgat" >> README.md
        git config --global user.email "action@github.com"
        git config --global user.name "GitHub Action"
        git add README.md
        git commit -m "Update README with release info" || true
        git push || true
